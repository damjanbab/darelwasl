# Run run-tasks-001

Goal: deliver a fully usable local task app (login as huda/damjan, manage tasks end-to-end) with all checks implemented and passing. No stubs or follow-up tasks for core functionality.

## Tasks

- Task ID: product-spec
  - Status: done
  - Objective: Product spec in `docs/system.md` (tasks + auth) with fields, flows, acceptance.
  - Dependencies: requirements from user

- Task ID: design-spec
  - Status: done
  - Objective: Design spec in `docs/system.md` (visual language, theme, layout, components).
  - Dependencies: product-spec

- Task ID: theme-registry
  - Status: done
  - Objective: Theme tokens in `registries/theme.edn`; note CSS-var generation plan.
  - Dependencies: design-spec

- Task ID: registries-complete
  - Status: done
  - Objective: Schema/actions/views/tooling/theme registries reflect tasks/auth; no placeholders.

# Backend

- Task ID: backend-project-setup
  - Status: done (Codex, 2025-12-06 17:11 UTC)
  - Objective: Create Clojure + Datomic Local service scaffold with deps, config, and start scripts.
  - Scope: deps.edn with aliases, env/config handling with defaults, base router + middleware, health endpoint, start command and docs, Datomic dev-local client/connect helper (no auth/creds) wired for future schema/tasks.
  - Out of Scope: auth/session flows, task CRUD endpoints, schema migrations, frontend work, CI wiring beyond start/health proof.
  - Capabilities Touched: [:cap/schema/user :cap/schema/task] (runtime support only)
  - Parallel Safety:
    - Exclusive Capabilities: backend runtime scaffold (server entrypoint, routing, config, Datomic dev-local bootstrap)
    - Shared/Read-only Capabilities: registries (read), fixtures (read)
    - Sequencing Constraints: precedes datomic-setup/auth-implementation/task-api-implementation/fixtures-loader
  - Composability Impact:
    - Layers Affected: tooling/runtime (backend server + Datomic client wiring)
    - Patterns/Registries Reused: config-from-env with defaults; ring/reitit router skeleton
    - New Composability Rules: none
  - Requirement Change & Compatibility: adds runnable backend skeleton; additive/non-breaking; no flags or rollout needed.
  - Breaking/Deprecation: none
  - Dependencies: registries-complete
  - Deliverables: deps.edn + src namespaces for config/db/server/main, health route returning 200 JSON, Datomic dev-local helper, start instructions documented.
  - Proof Plan: start server via `clojure -M:dev`, curl /health returns 200 with service + datastore status.
  - Fixtures/Data Assumptions: none required beyond existing registry fixtures.
  - Protocol/System Updates: document backend start/config defaults in docs/system.md.
  - FAQ Updates: none expected.
  - Tooling/Automation: start alias/command only; no CI wiring yet.
  - Reporting: PR notes server scaffolding, health endpoint, Datomic wiring, proof outputs.

- Task ID: datomic-setup
  - Status: done (Codex, 2025-12-06 17:55 UTC)
  - Objective: Configure Datomic Local (dev-local, no auth), connection utilities, and schema loader for temp DB.
  - Scope: Datomic config, connection helper, temp DB load function for checks; no cloud/auth.
  - Acceptance: Temp DB load works for schema; config documented; no credentials required.
  - Dependencies: backend-project-setup, schema-tasks, schema-users
  - Proof Plan: scripts/checks.sh schema (once implemented)

- Task ID: auth-implementation
  - Status: done (Codex, 2025-12-06 18:54 UTC)
  - Objective: Implement login/session for users huda/damjan (password `Damjan1!`), session cookie (in-memory), error handling.
  - Scope: POST /api/login handler, session middleware for protected routes, 401 on bad creds, structured error responses; logout optional; plaintext password acceptable for dev.
  - Out of Scope: frontend login UI changes, task endpoints, password hashing/rotation, multi-tenant/authz.
  - Capabilities Touched: [:cap/action/auth-login :cap/schema/user :cap/integration/local-session]
  - Parallel Safety:
    - Exclusive Capabilities: [:cap/action/auth-login :cap/integration/local-session]
    - Shared/Read-only Capabilities: [:cap/schema/user :fixtures/users]
    - Sequencing Constraints: after backend-project-setup/datomic-setup; precedes task-api-implementation, frontend-login, checks-action-contract
  - Composability Impact:
    - Layers Affected: actions, integrations, runtime middleware
    - Patterns/Registries Reused: reitit/ring middleware stack, fixtures-driven user lookup, registry-defined auth action contract
    - New Composability Rule Needed: none
  - Requirement Change & Compatibility:
    - What requirement is changing and why: fulfill :cap/action/auth-login contract with real session handling so downstream APIs/views can rely on auth.
    - Compatibility expectation: backward/forward compatible; no flags.
    - Flag/Rollout plan: none.
  - Breaking/Deprecation: none; additive local auth only.
  - Dependencies: backend-project-setup, datomic-setup, registry-actions-auth, fixtures-users
  - Deliverables: /api/login endpoint, session middleware wiring, credential validation against fixtures, 200/401 responses with messages, curl examples/docs updates as needed.
  - Proof Plan: scripts/checks.sh actions (auth) after harness ready; manual curl login/401 smoke; clj server start check.
  - Fixtures/Data Assumptions: fixtures/users.edn with huda and damjan using password `Damjan1!`.
  - Protocol/System Updates: update docs/system.md to record auth runtime flow/commands if shifted.
  - FAQ Updates: none expected.
  - Tooling/Automation: reuse existing start alias; no new scripts required.
  - Reporting: summarize auth endpoint/session behavior, proofs run/results, and any registry/doc touches.

- Task ID: task-api-implementation
  - Status: done (Codex, 2025-12-06 21:11 UTC)
  - Objective: Implement task endpoints wired to Datomic: list with filters/sorts; create/update; status/assign/due/tags; archive.
  - Scope: REST/JSON handlers, validations for enums/flags, persistence, audit per registry, feature flag respect.
  - Out of Scope: Frontend/UI wiring, headless/app smoke harness, schema changes beyond registry, pagination or search beyond specified filters/sorts, auth/session mechanics beyond reuse of existing middleware.
  - Capabilities Touched: [:cap/action/task-create :cap/action/task-update :cap/action/task-set-status :cap/action/task-assign :cap/action/task-set-due :cap/action/task-set-tags :cap/action/task-archive :cap/schema/task :cap/schema/user]
  - Acceptance: Endpoints match action contracts; filters (status/assignee/tag/priority) and sorts (due/priority/updated) work; uses session auth.
  - Dependencies: auth-implementation, datomic-setup, registry-actions-tasks, fixtures-tasks
  - Parallel Safety:
    - Exclusive Capabilities: [:cap/action/task-create :cap/action/task-update :cap/action/task-set-status :cap/action/task-assign :cap/action/task-set-due :cap/action/task-set-tags :cap/action/task-archive]
    - Shared/Read-only Capabilities: [:cap/schema/task :cap/schema/user :fixtures/tasks :fixtures/users]
    - Sequencing Constraints: after auth-implementation/datomic-setup/registry-actions-tasks/fixtures-tasks; precedes frontend-task-list/frontend-task-detail/checks-action-contract/checks-app-smoke
  - Composability Impact:
    - Layers Affected: actions + backend runtime routing/integration with Datomic
    - Patterns/Registries Reused or Extended: reitit/ring routes, Datomic helpers from datomic-setup, action registry contracts, fixture-driven validation; no new adapters introduced
    - New Composability Rule Needed: none
  - Requirement Change & Compatibility:
    - What requirement is changing and why: deliver real task CRUD/list APIs aligned to registry contracts so frontend and checks can depend on them.
    - Compatibility expectation: backward/forward compatible with registry definitions; honors :task/extended? flag default false.
    - Flag/Rollout plan: feature-flagged fields remain gated behind :task/extended?; otherwise no new flags.
  - Breaking/Deprecation: none; additive implementation of existing contracts.
  - Deliverables: Auth-protected task routes (list with filters/sorts; create/update/status/assign/due/tags/archive), validation against enums/flags, Datomic persistence and audit logging per registry, documented curl examples using existing start/seed commands.
  - Proof Plan: scripts/checks.sh actions (tasks) after harness ready; manual curl smoke (login + list/create/update/status/assign/tag/due/archive) against dev server.
  - Fixtures/Data Assumptions: uses fixtures/users for auth and fixtures/tasks enums/IDs for validation; temp/dev Datomic allowed.
  - Protocol/System Updates: none expected unless runtime commands shift (document if so).
  - FAQ Updates: none expected.
  - Tooling/Automation: reuse existing start/seed commands; no new tooling beyond potential curls in docs.
  - Reporting: summarize endpoints/behaviors, capability IDs touched, proofs run/results, and any doc/registry updates.

- Task ID: fixtures-loader
  - Status: done (Codex, 2025-12-06 18:58 UTC)
  - Objective: Wire fixtures (users/tasks) into backend/test harness; provide seed/load command.
  - Scope: loader for Datomic temp DB and dev DB; bb/clj task to seed.
  - Acceptance: Seed command loads users/tasks; used by action tests and app smoke.
  - Dependencies: datomic-setup, fixtures-users, fixtures-tasks
  - Proof Plan: seed invoked in checks; scripts/checks.sh uses it
  - Commands: e.g., `bb seed` or `clojure -M:dev -m fixtures.seed` documented

# Frontend

- Task ID: frontend-scaffold
  - Status: done (Codex, 2025-12-06 16:56 UTC)
  - Objective: Scaffold shadow-cljs + re-frame; define build/dev/test commands; include base layout shell.
  - Scope: shadow-cljs.edn, package.json scripts, base app root, state setup, minimal layout shell that consumes theme CSS vars when available.
  - Out of Scope: wiring to backend APIs, login/task feature flows, theme CSS var generation, headless smoke harness.
  - Capabilities Touched: [:cap/view/login :cap/view/tasks :cap/tooling/app-smoke]
  - Parallel Safety:
    - Exclusive Capabilities: frontend build/runtime scaffold (package.json, shadow-cljs config, app root/layout shell)
    - Shared/Read-only Capabilities: theme registry (read), docs (read), registries (read)
    - Sequencing Constraints: precedes theme-css-vars, frontend-login, frontend-task-list, frontend-task-detail, checks-app-smoke
  - Composability Impact:
    - Layers Affected: views/apps, tooling (frontend build/start commands)
    - Patterns/Registries Reused: theme tokens from `registries/theme.edn`, re-frame event/state model
    - New Composability Rules: none
  - Requirement Change & Compatibility:
    - Adds runnable frontend scaffold; additive/backward-compatible; no flags or rollout.
  - Breaking/Deprecation: none.
  - Dependencies: design-spec, theme-registry
  - Deliverables: package.json with scripts (install/dev/build/test placeholder), shadow-cljs.edn app build, src namespaces for app entry/root/layout, public index/asset wiring, docs for commands.
  - Proof Plan: run `npm install` and `npm run build`; document results.
  - Fixtures/Data Assumptions: uses default theme tokens; no data fixtures required.
  - Protocol/System Updates: add frontend commands/start notes to docs/system.md if new.
  - FAQ Updates: none expected.
  - Tooling/Automation: npm scripts for dev/build; hook into scripts/checks.sh views placeholder as needed.
  - Reporting: summarize scaffold, commands, proofs, and any doc/registry updates.

- Task ID: theme-css-vars
  - Status: done (Codex, 2025-12-06 17:47 UTC)
  - Objective: Generate CSS vars from `registries/theme.edn` and consume in frontend shell.
  - Scope: wire theme-var generation into dev/build so a stylesheet is emitted from the registry; import it in the app; ensure layout components rely solely on generated tokens (no hardcoded theme values); document usage.
  - Out of Scope: new UI flows beyond the shell, backend changes, altering theme tokens themselves.
  - Capabilities Touched: [:cap/tooling/theme-css-vars :theme/default :cap/view/login :cap/view/tasks]
  - Parallel Safety:
    - Exclusive Capabilities: [:cap/tooling/theme-css-vars :theme/default :cap/view/login :cap/view/tasks]
    - Shared/Read-only Capabilities: [:cap/tooling/app-smoke]
    - Sequencing Constraints: after frontend-scaffold and theme-registry; precedes frontend-login/frontend-task-list/frontend-task-detail and checks-app-smoke
  - Composability Impact:
    - Layers affected / patterns reused/extended: tooling (theme var generator) reused; views consume generated CSS vars for theming; reinforces registry-driven styling.
    - New composability rules needed: none (restate "no hardcoded theme values; use generated CSS vars").
  - Requirement Change & Compatibility:
    - Requirement change and rationale: move theme consumption to registry-driven CSS vars via generated stylesheet so registry stays source of truth.
    - Compatibility expectation (backward/forward/none): backward/forward compatible; no flags.
    - Flag/Rollout plan: none.
  - Breaking/Deprecation:
    - Breaking change? Deprecation plan/timeline/mitigations: none.
  - Dependencies: frontend-scaffold, theme-registry
  - Deliverables: generated theme CSS vars file wired into public assets, build/dev scripts invoking generator, frontend styles consuming vars, docs updates if pipeline shifts.
  - Proof Plan: scripts/theme-css-vars.sh default run; npm run build; scripts/checks.sh registries
  - Fixtures/Data Assumptions: none.
  - Protocol/System Updates: update docs/system.md if theme tooling usage changes.
  - FAQ Updates: none expected.
  - Tooling/Automation: add npm script/integration for CSS var generation using existing script.
  - Reporting: summarize CSS var pipeline, files touched (HTML/CSS/CLJS/scripts), proofs run/results.

- Task ID: frontend-login
  - Status: done (Codex, 2025-12-06 19:35 UTC)
  - Objective: Build login view wired to /api/login with error states; uses theme.
  - Scope: dedicated login screen using theme tokens; username/password form with inline validation; submit via re-frame event calling backend; loading/success/error states; success stores session token/user and switches to tasks shell; responsive layout for desktop/mobile.
  - Out of Scope: task list/detail implementation, headless smoke harness, routing beyond login->tasks toggle, password hashing/authz changes.
  - Capabilities Touched: [:cap/view/login :cap/action/auth-login]
  - Parallel Safety:
    - Exclusive Capabilities: [:cap/view/login]
    - Shared/Read-only Capabilities: [:cap/action/auth-login :cap/tooling/theme-css-vars]
    - Sequencing Constraints: after frontend-scaffold/theme-css-vars/auth-implementation; precedes frontend-task-list/frontend-task-detail/checks-app-smoke
  - Composability Impact:
    - Layers Affected: views/apps
    - Patterns/Registries Reused or Extended: theme CSS vars consumption, finite-state UI model for loading/error/ready, auth action contract for POST /api/login
    - New Composability Rule Needed: none
  - Requirement Change & Compatibility:
    - What requirement is changing and why: fulfill product/login spec with real UI that calls auth endpoint and manages session state.
    - Compatibility expectation: backward/forward compatible; no flags.
    - Flag/Rollout plan: none.
  - Breaking/Deprecation: none.
  - Dependencies: frontend-scaffold, theme-css-vars, auth-implementation, registry-view-login
  - Deliverables: login view components/styles wired to backend, re-frame events/effects for submit + state handling, session persistence in app state, navigation to tasks shell on success, docs/examples as needed.
  - Proof Plan: npm run build; scripts/checks.sh views (current harness)
  - Fixtures/Data Assumptions: use fixtures/users credentials (huda/damjan with Damjan1!); relies on session cookie.
  - Protocol/System Updates: none expected.
  - FAQ Updates: none expected.
  - Tooling/Automation: none beyond existing npm/shadow-cljs commands.
  - Reporting: summarize login UX/flows, capabilities touched, proofs run/results.

- Task ID: frontend-task-list
  - Status: done (Codex, 2025-12-06 22:08 UTC)
  - Objective: Deliver the task list pane with filters/sorts and explicit loading/empty/error states.
  - Scope: build list layout for desktop/mobile; fetch tasks from /api/tasks using the session cookie; filters (status/assignee/tag/priority); sorts (due/priority/updated); render badges for status/priority/tags; show loading/empty/error states; keep theme token usage.
  - Out of Scope: detail/edit interactions (frontend-task-detail), create/update flows, headless app smoke harness, backend schema/action changes, new theme tokens.
  - Capabilities Touched: [:cap/view/tasks] (read-only consumption of task APIs)
  - Parallel Safety:
    - Exclusive Capabilities: [:cap/view/tasks]
    - Shared/Read-only Capabilities: [:cap/action/auth-login :cap/tooling/theme-css-vars :cap/view/login]
    - Sequencing Constraints: after frontend-scaffold/theme-css-vars/task-api-implementation/registries-complete; before frontend-task-detail and checks-app-smoke
  - Composability Impact:
    - Layers Affected: views/apps
    - Patterns/Registries Reused or Extended: theme CSS vars, finite state handling for UX states, registry-driven task view contract; reuse fixtures for data examples.
    - New Composability Rule Needed: none
  - Requirement Change & Compatibility:
    - What requirement is changing and why: replace placeholder workspace cards with a real task list that honors filters/sorts per product spec so users can browse tasks after login.
    - Compatibility expectation: backward/forward compatible; uses existing APIs/theme tokens; no flags.
    - Flag/Rollout plan: none.
  - Breaking/Deprecation: none.
  - Dependencies: [frontend-scaffold, theme-css-vars, task-api-implementation, registries-complete]
  - Deliverables: CLJS state/events for task list fetch + filters/sorts; UI components for list, filter controls, status/priority/tag chips, and empty/error/loading states; responsive CSS updates; doc/registry touch only if contracts shift.
  - Proof Plan: npm run build; scripts/checks.sh views; manual login + filter/sort smoke as needed.
  - Fixtures/Data Assumptions: uses fixtures/users for login and fixtures/tasks for list/filter coverage; session cookie required.
  - Protocol/System Updates: none expected.
  - FAQ Updates: none expected.
  - Tooling/Automation: reuse theme generator + shadow-cljs scripts; no new tooling.
  - Reporting: summarize list UX, capabilities touched, proofs run/results.

- Task ID: frontend-task-detail
  - Status: done (Codex, 2025-12-06 23:18 UTC)
  - Objective: Build task detail/edit pane with full interactions.
  - Scope: detail side panel for viewing/editing existing tasks; create new tasks; change status/assignee; set/clear due date; add/remove tags; archive/unarchive; honor :task/extended? flag gating extended fields.
  - Out of Scope: backend schema/API changes, theme token changes, new filters/sorts, auth/session mechanics, headless smoke harness wiring (covered by checks-app-smoke).
  - Capabilities Touched: [:cap/view/tasks] (consumes :cap/action/task-* contracts)
  - Parallel Safety:
    - Exclusive Capabilities: [:cap/view/tasks]
    - Shared/Read-only Capabilities: [:cap/action/auth-login :cap/action/task-create :cap/action/task-update :cap/action/task-set-status :cap/action/task-assign :cap/action/task-set-due :cap/action/task-set-tags :cap/action/task-archive :cap/tooling/theme-css-vars :cap/view/login]
    - Sequencing Constraints: after frontend-task-list/task-api-implementation; before checks-app-smoke
  - Composability Impact:
    - Layers Affected: views/apps
    - Patterns/Registries Reused or Extended: theme CSS vars consumption; finite-state UI model for loading/error/ready; reuse task action contracts for mutations; session-based API client patterns from list/login views
    - New Composability Rule Needed: none
  - Requirement Change & Compatibility:
    - What requirement is changing and why: deliver full task detail/edit UI per product spec so users can manage tasks end-to-end from the frontend.
    - Compatibility expectation: backward/forward compatible with existing APIs and theme tokens; no new flags beyond :task/extended? already present.
    - Flag/Rollout plan: ensure :task/extended? gated fields remain behind existing flag; no new toggles.
  - Breaking/Deprecation: none expected.
  - Dependencies: frontend-task-list, task-api-implementation
  - Deliverables: CLJS detail pane components/events for view/create/edit/archive/status/assignee/due/tags; feature-flagged field handling; responsive styles; state management for loading/error/ready; doc/registry updates only if contracts shift.
  - Proof Plan: scripts/checks.sh views; app-smoke covers detail when added.
  - Fixtures/Data Assumptions: uses fixtures/users for auth and fixtures/tasks for data coverage; assumes session cookie present.
  - Protocol/System Updates: none expected.
  - FAQ Updates: none expected.
  - Tooling/Automation: none beyond existing npm/shadow-cljs commands; reuse theme CSS var generator.
  - Reporting: summarize detail UX/flows, capabilities touched, proofs run/results.

# Checks and Tooling

- Task ID: checks-edn-validate
  - Status: done
  - Objective: Real EDN validation in scripts/checks.sh (implemented).

- Task ID: checks-schema-load
  - Status: done (Codex, 2025-12-06 19:17 UTC)
  - Objective: Implement schema load check using temp Datomic; pin command in `scripts/checks.sh schema`.
  - Scope: real clj/bb command that reads `registries/schema.edn` and transacts into a temp dev-local DB (default :mem) using existing helpers; ensure non-zero exit on failure; document invocation.
  - Out of Scope: action contract harness, frontend/app smoke checks, schema migrations beyond registry definitions.
  - Capabilities Touched: [:cap/tooling/schema-load :cap/schema/user :cap/schema/task]
  - Parallel Safety:
    - Exclusive Capabilities: [:cap/tooling/schema-load]
    - Shared/Read-only Capabilities: [:cap/schema/user :cap/schema/task :fixtures/users :fixtures/tasks]
    - Sequencing Constraints: after datomic-setup and fixtures-loader; precedes checks-action-contract and checks-update-script
  - Composability Impact:
    - Layers Affected: tooling/checks
    - Patterns/Registries Reused or Extended: `darelwasl.schema/temp-db-with-schema!`, `registries/schema.edn`, shared `scripts/checks.sh` entrypoint
    - New Composability Rule Needed: none (reaffirm shared checks entrypoint, registry-driven schema load)
  - Requirement Change & Compatibility:
    - What requirement is changing and why: deliver a real schema load proof so registry-defined schema is validated via the shared harness.
    - Compatibility expectation: backward/forward compatible; no flags.
    - Flag/Rollout plan: none.
  - Breaking/Deprecation: none.
  - Dependencies: datomic-setup, fixtures-loader
  - Deliverables: working schema check command invoked via `scripts/checks.sh schema`, supporting script/namespace, and any doc/registry updates needed for tooling capability.
  - Proof Plan: run `scripts/checks.sh schema`.
  - Fixtures/Data Assumptions: uses registry-defined schema and temp Datomic (:mem) with no persistent side effects.
  - Protocol/System Updates: update docs/system.md if schema check invocation or capability narrative shifts.
  - FAQ Updates: none expected.
  - Tooling/Automation: integrate check into shared script; no additional automation beyond entrypoint.
  - Reporting: include command output/result and any doc/registry updates in PR/report.

- Task ID: checks-action-contract
  - Status: done (Codex, 2025-12-06 22:04 UTC)
  - Objective: Action contract harness for auth/tasks using fixtures; pin command in scripts/checks.sh actions.
  - Scope: tests verifying inputs/outputs, side effects, idempotency, audit expectations per registry.
  - Acceptance: `scripts/checks.sh actions` runs and passes against fixtures.
  - Dependencies: auth-implementation, task-api-implementation, fixtures-loader

- Task ID: checks-app-smoke
  - Status: done (Codex, 2025-12-07 00:43 UTC)
  - Objective: Headless app smoke via shadow-cljs + chosen runner (Karma/ChromeHeadless or Playwright); pin command in scripts/checks.sh app-smoke.
  - Scope: headless config, minimal smoke test that logs in and renders task list/detail.
  - Out of Scope: Backend contract changes, theme/token updates, new UI features beyond smoke coverage, CI wiring beyond shared checks entrypoint.
  - Capabilities Touched: [:cap/tooling/app-smoke :cap/view/login :cap/view/tasks :cap/action/auth-login :cap/action/task-create :cap/action/task-update :cap/action/task-set-status :cap/action/task-assign :cap/action/task-set-due :cap/action/task-set-tags :cap/action/task-archive]
  - Parallel Safety:
    - Exclusive Capabilities: [:cap/tooling/app-smoke]
    - Shared/Read-only Capabilities: [:cap/view/login :cap/view/tasks :cap/action/auth-login :cap/action/task-create :cap/action/task-update :cap/action/task-set-status :cap/action/task-assign :cap/action/task-set-due :cap/action/task-set-tags :cap/action/task-archive :cap/tooling/theme-css-vars]
    - Sequencing Constraints: after frontend-login/frontend-task-detail/fixtures-loader; before checks-update-script.
  - Composability Impact:
    - Layers Affected: tooling/checks for views/actions
    - Patterns/Registries Reused or Extended: shadow-cljs build, fixture-driven login/task flows, theme CSS var consumption, shared scripts/checks.sh entrypoint
    - New Composability Rule Needed: none
  - Requirement Change & Compatibility:
    - What requirement is changing and why: convert :cap/tooling/app-smoke from placeholder to real headless smoke covering login + task list/detail to catch regressions.
    - Compatibility expectation: backward/forward compatible; no flags.
    - Flag/Rollout plan: none.
  - Breaking/Deprecation: none.
  - Dependencies: frontend-login, frontend-task-detail, fixtures-loader
  - Deliverables: Headless runner config (Karma/ChromeHeadless or Playwright) wired to shadow-cljs, deterministic smoke that logs in with fixtures and exercises task list/detail, scripts/checks.sh app-smoke command invoking it, registry/doc updates if invocation or gotchas shift.
  - Proof Plan: `scripts/checks.sh app-smoke` (includes underlying runner invocation).
  - Fixtures/Data Assumptions: Uses fixtures/users (huda/damjan with Damjan1!), fixtures/tasks for list/detail content; requires session cookie from /api/login.
  - Protocol/System Updates: Update docs/system.md and tooling registry if runner/invocation or expectations change.
  - FAQ Updates: Note headless runner requirements (e.g., Chrome install flags) if any quirks emerge.
  - Tooling/Automation: Extend shared checks entrypoint; avoid bespoke scripts beyond runner config.
  - Reporting: Summarize smoke coverage, commands wired, proofs/results.

- Task ID: checks-update-script
  - Status: done (Codex, 2025-12-07 01:25 UTC)
  - Objective: Update scripts/checks.sh to include real commands for schema, actions, app-smoke; ensure `scripts/checks.sh all` runs everything.
  - Scope: wire commands from the above tasks; ensure exits non-zero on failure.
  - Out of Scope: changing underlying check implementations or contracts beyond invoking them; adding new capabilities.
  - Capabilities Touched: [:cap/tooling/edn-validate :cap/tooling/schema-load :cap/tooling/action-contract :cap/tooling/app-smoke]
  - Parallel Safety:
    - Exclusive Capabilities: [:cap/tooling/edn-validate :cap/tooling/schema-load :cap/tooling/action-contract :cap/tooling/app-smoke]
    - Shared/Read-only Capabilities: registries (read), fixtures (read)
    - Sequencing Constraints: after checks-schema-load, checks-action-contract, checks-app-smoke; precedes any CI wiring follow-ups.
  - Composability Impact:
    - Layers Affected: tooling/checks entrypoint
    - Patterns/Registries Reused or Extended: shared scripts/checks.sh entrypoint orchestrating registered checks; no new adapters.
    - New Composability Rule Needed: none
  - Requirement Change & Compatibility:
    - What requirement is changing and why: make `scripts/checks.sh all` run the real schema/action/app-smoke checks to enforce full proof coverage.
    - Compatibility expectation: backward/forward compatible; no flags.
    - Flag/Rollout plan: none.
  - Breaking/Deprecation: none.
  - Dependencies: checks-schema-load, checks-action-contract, checks-app-smoke
  - Deliverables: updated scripts/checks.sh with working targets for schema/actions/app-smoke and all aggregate.
  - Proof Plan: `scripts/checks.sh all`.
  - Fixtures/Data Assumptions: uses existing fixtures (users/tasks) via underlying checks.
  - Protocol/System Updates: none expected.
  - FAQ Updates: none expected.
  - Tooling/Automation: reuse scripts/checks.sh; no new scripts beyond entrypoint updates.
  - Reporting: summarize entrypoint changes and proof results.

# Fixtures

- Task ID: fixtures-users
  - Status: done (Codex, 2025-12-06 18:22 UTC)
  - Objective: Finalize canonical user fixtures (huda, damjan) with stable IDs/password for auth and downstream checks.
  - Scope: Validate/update `fixtures/users.edn` to align with `:cap/schema/user`, document usage assumptions for seed/tests, ensure compatibility with registries.
  - Out of Scope: Changes to user schema or auth implementation; fixture loader tooling (covered by other tasks).
  - Capabilities Touched: [:cap/schema/user]
  - Parallel Safety:
    - Exclusive Capabilities: [:cap/schema/user]
    - Shared/Read-only Capabilities: [:cap/schema/task]
    - Sequencing Constraints: after registries-complete; before auth-implementation, fixtures-loader, checks-* that rely on user data
  - Composability Impact:
    - Layers Affected: fixtures/test-data
    - Patterns/Registries Reused: schema registry for users; stable UUID/password fixtures; registry-driven data consistency
    - New Composability Rule Needed: none
  - Requirement Change & Compatibility:
    - Requirement Change: make user fixtures canonical and referenced for auth/tests so downstream tasks rely on stable data
    - Compatibility Expectation: backward/forward compatible (no flags)
    - Flag/Rollout Plan: none
  - Breaking/Deprecation: none (no schema or contract breakage)
  - Dependencies: [registries-complete]
  - Deliverables: updated/validated `fixtures/users.edn`, documentation notes if assumptions shift, registry alignment confirmed.
  - Proof Plan: `scripts/checks.sh registries`; load `fixtures/users.edn` via clj REPL snippet to confirm validity/alignment.
  - Fixtures/Data Assumptions: two users with fixed UUIDs and shared password `Damjan1!`; usernames unique.
  - Protocol/System Updates: none expected unless fixture handling changes.
  - FAQ Updates: none expected.
  - Tooling/Automation: no new tooling (loader handled in fixtures-loader task).
  - Reporting: note fixture contents/IDs/password assumptions, proofs run/results, any doc updates.

- Task ID: fixtures-tasks
  - Status: done (Codex, 2025-12-06 17:00 UTC)
  - Objective: Ensure tasks fixtures are final and referenced.
  - Acceptance: fixtures/tasks.edn correct; used by seed and tests; includes status/priority/tags coverage.
  - Dependencies: schema-tasks

# Docs

- Task ID: protocol-prompt-hardening
  - Status: done (Codex, 2025-12-06 16:24 UTC)
  - Objective: Harden the initial prompt to prevent token/auth hiccups; clarify loader usage and fallback token sourcing.
  - Scope: Update `docs/protocol.md` initial prompt text.
  - Out of Scope: Changing loader scripts or task definitions.
  - Capabilities Touched: docs/protocol.md
  - Dependencies: theme-registry
  - Proof Plan: none (doc change)
  - Reporting: summarize prompt change

- Task ID: docs-commands
  - Status: pending
  - Objective: Update docs/system.md and docs/faq.md with start/run/test commands, acceptance summaries, and any gotchas; ensure registries match code.
  - Scope: backend start, fixture seed, frontend dev/build, checks commands, acceptance per task (brief).
  - Out of Scope: Changing runtime defaults or adding new features/flags; code edits beyond doc/registry sync.
  - Capabilities Touched: [:cap/tooling/schema-load :cap/tooling/action-contract :cap/tooling/app-smoke :cap/tooling/fixtures-loader :cap/tooling/theme-css-vars :cap/tooling/edn-validate :cap/view/login :cap/view/tasks]
  - Parallel Safety:
    - Exclusive Capabilities: documentation for docs/system.md and docs/faq.md
    - Shared/Read-only Capabilities: registries (read), existing capabilities referenced
    - Sequencing Constraints: after implementation tasks to reflect final commands.
  - Composability Impact:
    - Layers Affected: documentation of tooling/views
    - Patterns/Registries Reused or Extended: registry entries for tooling/view capabilities; doc command tables
    - New Composability Rule Needed: none
  - Requirement Change & Compatibility:
    - What requirement is changing and why: document current run/command contracts for usability and future checks.
    - Compatibility expectation: backward/forward compatible; no flags.
    - Flag/Rollout plan: none.
  - Breaking/Deprecation: none.
  - Dependencies: all implementation tasks
  - Deliverables: Updated docs/system.md and docs/faq.md entries with verified commands and acceptance notes; registry references aligned.
  - Proof Plan: `scripts/checks.sh registries`; spot-check commands where updated.
  - Fixtures/Data Assumptions: uses fixtures/users and fixtures/tasks for documented examples.
  - Protocol/System Updates: none expected beyond doc edits.
  - FAQ Updates: add any gotchas encountered while verifying commands.
  - Tooling/Automation: none beyond existing scripts; note invocations for future runs.
  - Reporting: summarize doc updates and command verification.

## Notes
- Follow protocol: claim one task, respect dependencies/parallel safety, run proofs, branch per task, merge only when green.
- Aim for zero stubs: each implementation task must meet its acceptance and command expectations.***
